backup_packages() {
    read -p "Enter the directory where you want to save backup: " DIRECTORY

    DIRECTORY=${DIRECTORY:-$(pwd)}

    if [ ! -d "$DIRECTORY" ]; then
        echo "The specified directory does not exist. Please create it first."
        exit 1
    fi

    OUTPUT_FILE="$DIRECTORY/backup.txt"

    if pacman -Q && yay -Q > "$OUTPUT_FILE"; then
        echo "Installed packages have been saved to $OUTPUT_FILE"
    else
        echo "The backup process has failed. please check errors for more."
    fi
}

batch_packages() {
    
}

update_packages() {
    echo "Updating packages installed with pacman"
    if sudo pacman -Syu; then
        echo "All pacman packages have been updated."
    else
        echo "There has been a problem with pacman packagers. Please check errors for more."
    fi
    echo "Updating yay packages"
    if yay -u; then
        echo "All yay packages have been updated."
    else
        echo "There has been a problem with yay packagers. Please check errors for more."
    fi
}    


install_package() {
    echo "Checking Pacman"
    if sudo pacman -Sy "$1"; then
        echo "Installation with Pacman was successful. Quitting..."
        exit 0
    else
        echo "Installation with Pacman has failed. Checking yay..."
    fi

    if yay -S "$1"; then
        echo "Installation with Yay was successful. Quitting..."
        exit 0
    else
        echo "Installation with Yay has failed, please double check your entered packages and errors."
    fi
}



show_help() {
    echo "install  Install specified packages using the available package manager/s."

    echo "update  Updates all installed packages using the available package manager/s."

    echo "Check https://github.com/devtracer/OmniPkg for more."
}


case "$1" in
    install)
        shift
        for package in "$@"; do
            install_package "$package"
        done
        ;;
    update)
        update_packages
        ;;
    backup)
        backup_packages
        ;;
    help|*)
        show_help
        ;;
esac